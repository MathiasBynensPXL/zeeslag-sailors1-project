<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Registratie</title>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="login.css">
</head>
<body>
<div class="wrapper fadeInDown">
    <div id="formContent">

        <!-- titel -->
        <div class="fadeIn first">
            <br><br>
            <h1>Registreren</h1><br>
        </div>

        <!-- register Form -->
        <form name="regForm">
            <input type="email" required="required" id="email" class="fadeIn second" name="email" placeholder="E-mail"><br>
            <input type="text" required="required" id="gebruikersnaam" class="fadeIn second" name="Gebruikersnaam" placeholder="gebruikersnaam"><br>
            <input type="password" required="required" id="paswoord" class="fadeIn third" name="login" placeholder="Wachtwoord"><br>
            <input type="password" required="required" id="checkPaswoord" class="fadeIn third" name="login" placeholder="Herhaal wachtwoord"><br>
            <input type="button" id="regPost" class="fadeIn fourth" value="registreren">
        </form>
        <script>
            window.addEventListener("load", loaded);
            function loaded() {
                let buttonPost = document.getElementById('regPost');
                buttonPost.addEventListener("click", regFunction);
            }

            function regFunction() {

                let email = document.getElementById('email').value;
                let gebruikersnaam = document.getElementById('gebruikersnaam').value;
                let paswoord = document.getElementById('paswoord').value;
                let checkPaswoord = document.getElementById('checkPaswoord').value;
                let user = { email: email, password: paswoord, nickName: gebruikersnaam };
                let url = 'https://localhost:5001/api/Authentication/register';

                if (email == "" || gebruikersnaam == "" || paswoord == "" || checkPaswoord == "") {
                    alert("Je hebt minstens 1 vak niet ingevuld.");
                    return;
                }
                if (paswoord.length < 6) {
                    alert("Wachtwoord moet minstens 6 tekens bevatten.");
                    return;
                }

                if (paswoord === checkPaswoord) {
                    fetch(url,
                        {
                            method: "POST",
                            body: JSON.stringify(user),
                            headers: {
                                'Accept': 'application/json',
                                'Content-Type': 'application/json'
                            }
                        })
                        .then((response) => {
                            if (response.status == 200) {
                                window.location.href = "https://localhost:5001/login_user.html";
                                return response.json();
                            } else {
                                alert("Er is iets misgelopen....");
                                throw `error with status ${response.status}`;
                            }
                        })
                        .then((user) => {
                            let data = [];
                            data.push([user.email, user.gebruikersnaam, user.paswoord]);

                        });

                } else {
                    alert("Wachtwoorden komen niet overeen!");
                    return;
                }
            }

        </script>
        <!-- terug naar login -->
        <div id="formFooter">
            <a class="underlineHover" href="login_user.html">Al een account? <br> Naar de login pagina.</a>

        </div>

    </div>
</div>
</body>
</html>